(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{248:function(e,t,a){"use strict";a.r(t);a(11),a(149),a(34),a(13);var n=a(0),l=a.n(n),i=a(5),r=a(14),c=a(2),s=a(52),o=a(125),d=a(238);const p=c.d.div.withConfig({displayName:"styled__NoData",componentId:"sc-1xlva08-0"})(["text-align:center;color:",";margin-top:40px;padding-bottom:20px;"],e=>e.theme.fg),m=Object(c.d)(s.a).withConfig({displayName:"styled__StyledSpinnerLoading",componentId:"sc-1xlva08-1"})(["&{position:absolute;top:0;right:0;transform:translate(50%,-50%);width:13px;height:13px;z-index:3;margin-right:4px;vertical-align:top;}"]),b=c.d.div.withConfig({displayName:"styled__DiscoverMorePage",componentId:"sc-1xlva08-2"})(["min-height:100vh;padding:30px 15px 0 15px;overflow:hidden;"]),u=c.d.div.withConfig({displayName:"styled__LabelWrapper",componentId:"sc-1xlva08-3"})(["display:flex;flex-wrap:wrap;min-height:160px;align-content:flex-start;"]),g=Object(c.d)(d.a).withConfig({displayName:"styled__StyledLabel",componentId:"sc-1xlva08-4"})(["&{position:relative;top:initial;bottom:initial;left:initial;right:initial;}"]),y=Object(c.d)(g).withConfig({displayName:"styled__PlaceStyledLabel",componentId:"sc-1xlva08-5"})(["&{width:55px;height:24px;margin-top:12px;margin-right:8px;animation:"," 1.5s infinite;}"],o.a),f=c.d.div.withConfig({displayName:"styled__StyledLoadingLabel",componentId:"sc-1xlva08-6"})(["margin-top:12px;margin-right:8px;position:relative;display:flex;align-items:center;font-size:12px;padding:6px 12px;border-radius:200px;line-height:1em;transition:all 0.3s;background-color:",';font-weight:400;&[data-selected="true"]{transform:scale(1.2);margin-left:10px;margin-right:20px;display:block;}'],e=>e.theme.secondary),h=c.d.div.withConfig({displayName:"styled__ListWrapper",componentId:"sc-1xlva08-7"})(["margin-top:30px;"]),x=c.d.div.withConfig({displayName:"styled__ListHeader",componentId:"sc-1xlva08-8"})(["display:flex;justify-content:space-between;"]),w=c.d.span.withConfig({displayName:"styled__Order",componentId:"sc-1xlva08-9"})(({theme:e,isSelected:t})=>({color:t?e.dg:"black",fontSize:16})),v=c.d.div.withConfig({displayName:"styled__Orders",componentId:"sc-1xlva08-10"})(["font-weight:bold;margin-right:30px;",':first-of-type{&::after{content:" | ";color:black;}}'],w),C=c.d.div.withConfig({displayName:"styled__ListContent",componentId:"sc-1xlva08-11"})(["margin-top:20px;padding-left:10px;padding-bottom:40px;"]);var O=a(237),j=a(50);function k(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class L extends j.a{constructor(...e){var t;super(...e),t=this,k(this,"requestPlaylistCat",(async function(e){return(await t.fetcher.get(e)).data.sub.filter(e=>e.hot).map(e=>e.name)})),k(this,"requestPlaylist",(async function(e){const a=await t.fetcher.get(e),{playlists:n,more:l}=a.data;return{list:n.map(e=>({imgUrl:e.coverImgUrl,title:e.name,desc:e.trackCount+"No.",type:"playlist"})),more:l}})),k(this,"getInitialData",(async function(){}))}}var E=new L,_=a(1),N=a.n(_),S=a(35),I=a(239),P=a(236),T=a(61);const A=["HOT","NEW"],K=Object(c.d)(u).withConfig({displayName:"PlaylistsMore__StyledLabelWrapper",componentId:"uk2gj8-0"})(["margin-top:10px;"]),R=({onLabelClick:e,selectedLabel:t,selectedSubLabel:a,setSelectedSubLabel:i,listData:c,setListData:s,isLoading:o,resetPage:d,type:p})=>{const{data:b}=Object(S.b)("/api/playlist/catlist",E.requestPlaylistCat),u=Object(n.useMemo)(()=>["All"].concat(b?Object(r.e)(b):new Array(8).fill("")),[b]),g=Object(n.useCallback)(e=>{const t=e.target.getAttribute("data-order");t&&t===e.target.innerHTML&&i(e=>t===e?e:(d(),s([]),t))},[d,s,i]),O=Object(n.useCallback)(t=>{const a=t.target.getAttribute("data-label");e(a)},[e]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(K,{onClick:O},u.map((e,a)=>l.a.createElement(T.b,{customPlaceholder:l.a.createElement(y,{text:"  "}),ready:!!e,key:a},l.a.createElement(f,{"data-label":e,"data-selected":e===t},e===t&&o&&l.a.createElement(m,null),"#"+e)))),l.a.createElement(h,null,l.a.createElement(x,null,l.a.createElement(I.a,{withoutBar:!0,songsCount:c.length}),l.a.createElement(v,{onClick:g},A.map(e=>l.a.createElement(w,{"data-order":e,isSelected:a===e,key:e},e)))),l.a.createElement(C,null,l.a.createElement(P.b,{list:c.length?c:new Array(2).fill({type:p})}),o&&l.a.createElement(P.b,{list:new Array(2).fill({type:p})}))))};R.propTypes={onLabelClick:N.a.func,selectedLabel:N.a.string,selectedSubLabel:N.a.string,setSelectedSubLabel:N.a.func,listData:N.a.array,setListData:N.a.func,isLoading:N.a.bool,resetPage:N.a.func,type:N.a.string};var D=R,U=(a(88),a(82));const H=Object(n.memo)((function({onChange:e,defaultActiveKey:t,activeTabKey:a,children:i,className:r}){const c=Object(n.useRef)([]),s=Object(n.useRef)(),[,o]=Object(U.b)(()=>({y:0})),[d,p]=Object(n.useState)(t),m=Object(n.useRef)([]),b=Object(n.useRef)(null),u=Object(n.useCallback)(e=>{const t=c.current.findIndex(t=>t===e),a=document.getElementsByClassName("my_tab_pane"),n=[].slice.call(a,0);s.current.scrollLeft=0;const l=n[0].getBoundingClientRect().x,i=n[t].getBoundingClientRect(),r=i.x+i.width/2-s.current.offsetWidth/2-l;o({x:r,from:{x:s.current.scrollLeft},onFrame:({x:e})=>{s.current.scrollLeft=e}})},[o]),g=Object(n.useCallback)(t=>{p(t),u(t),e&&e(t)},[u,e]);Object(n.useEffect)(()=>{p(a),u(a),e&&e(a)},[a,u,e]);const y=Object(n.useMemo)(()=>(c.current=[],l.a.Children.map(i,e=>{let t=!1;if(c.current.push(e.props.tabKey),e.props.tabKey===d){t=!0;const a=m.current[e.props.tabKey];e.props.forceRender?b.current=e.props.children:a||e.props.forceRender?a&&!e.props.forceRender&&(b.current=a):(m.current[e.props.tabKey]=e.props.children,b.current=e.props.children)}return l.a.cloneElement(e,{onTabClick:g,isActive:t})})),[d,i,g]);return l.a.createElement(l.a.Fragment,null,l.a.createElement("ul",{className:r,ref:s},y),b.current)}));H.propTypes={onChange:N.a.func,defaultActiveKey:N.a.string.isRequired,activeTabKey:N.a.string.isRequired,children:N.a.node,className:N.a.string};const M=Object(n.memo)((function({tab:e,className:t,onTabClick:a,tabKey:i}){const r=Object(n.useCallback)(e=>a.call(null,i,e),[a,i]);return l.a.createElement("li",{className:"my_tab_pane "+t,onClick:r},e)}));M.propTypes={tab:N.a.node,className:N.a.string,onTabClick:N.a.func,tabKey:N.a.string};const $=Object(c.d)(H).withConfig({displayName:"NewSongsMore__StyledTabs",componentId:"sc-17vbhan-0"})(["&{width:100%;white-space:nowrap;overflow-x:scroll;line-height:60px;position:sticky;top:0;z-index:999;background:",";}"],({theme:e})=>e.mg),q=Object(c.d)(M).withConfig({displayName:"NewSongsMore__StyledTabPane",componentId:"sc-17vbhan-1"})(["&{width:100px;font-size:16px;font-weight:bold;text-align:center;display:inline-block;vertical-align:top;color:",";}"],({isActive:e,theme:t})=>e?t.secondary:"white"),z=[{area:"All",id:0},{area:"Chinese",id:7},{area:"Europe and America",id:96},{area:"Japan",id:8},{area:"Korea",id:16}],B=({onLabelClick:e,listData:t,type:a})=>{const i=Object(n.useCallback)(t=>{e(z[t].id)},[e]);return l.a.createElement($,{onChange:i,defaultActiveKey:"0",activeTabKey:"0"},z.map((e,n)=>l.a.createElement(q,{tab:e.area,forceRender:!0,tabKey:""+n,key:e.id},l.a.createElement(h,null,l.a.createElement(P.b,{list:t.length?t:new Array(2).fill({type:a})})))))};B.propTypes={onLabelClick:N.a.func,listData:N.a.array,type:N.a.string};var W=B,F=a(26);const J={playlist:{getUrl:(e,t,a)=>e&&`/api/top/playlist?limit=10&order=${a||"HOT"}&cat=${e}&offset=${t}`,selector:({playlists:e,more:t})=>({list:e.map(e=>({imgUrl:e.coverImgUrl,title:e.name,desc:e.trackCount+"首",type:"playlist",id:e.id})),more:t}),PagePart:D},song:{getUrl:(e=0)=>"/api/top/song?type="+e,selector:({data:e})=>({list:e.map(e=>{var t;const a=e.artists.length?[...e.artists].reverse().reduce((e,t)=>`${t.name} ${e}`,""):"";return{imgUrl:e.album.picUrl,title:""+e.name,desc:`${a} · ${e.album.name}`,artistId:null===(t=e.artists[0])||void 0===t?void 0:t.id,albumId:e.album.id,artistName:a,albumName:e.album.name,type:"song",id:e.id}}),more:!1}),PagePart:W}},Y="playlist",G=Object(n.memo)(()=>{const e=Object(n.useRef)(0),t=Object(n.useRef)(),a=Object(i.i)(),[c,s]=Object(n.useState)(!1),[o,d]=Object(n.useState)(!0),[m,u]=Object(n.useState)(()=>{if(a.type===Y)return"全部"}),[g,y]=Object(n.useState)([]),[f,h]=Object(n.useState)(()=>{if(a.type===Y)return"HOT"});Object(F.c)(()=>{document.getElementById("root").scrollTop=0},[]);const x=Object(n.useCallback)(()=>{e.current=0},[]),{getUrl:w,selector:v,PagePart:C}=J[a.type],j=Object(n.useCallback)(e=>{null!=e&&u(t=>e===t?t:(d(!0),x(),y([]),e))},[x]),k=Object(n.useCallback)(e=>E.fetcher.get(e).then(e=>e.data).then(v),[v]),L=Object(n.useCallback)(async()=>{const t=w(m,e.current,f);if(!t)return Promise.resolve();s(!0);const[a,n]=await Object(r.a)(k)(t);s(!1),a?console.error(a):n&&(d(n.more),y(e=>[...e,...n.list]))},[w,k,m,f]),_=Object(n.useCallback)(()=>{window.scrollY+30>t.current.clientHeight-window.innerHeight&&!c&&o&&(e.current+=1,L())},[c,o,L]);return Object(n.useEffect)(()=>{const e=Object(r.f)(_,300);return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[_]),Object(n.useEffect)(()=>{L()},[L]),l.a.createElement(b,{ref:t},l.a.createElement(O.a,null),l.a.createElement(C,{onLabelClick:j,selectedLabel:m,selectedSubLabel:f,setSelectedSubLabel:h,isLoading:c,listData:g,setListData:y,resetPage:x,type:a.type,request:L}),!o&&l.a.createElement(p,null,"This is the last one"))});G.csr=!0;t.default=G}}]);
//# sourceMappingURL=discover-more-ff24bc2bea6fe4632482.js.map